# XJ 能源平衡计算系统打包说明

## 项目概述
这是一个园区用电用热负荷与出力平衡计算系统，包含以下主要功能：
- 项目管理（创建、打开、删除项目）
- 数据导入（电力负荷、热力负荷、光照强度、风速）
- 风机和光伏型号管理
- 检修和投产计划设置
- 年度平衡计算
- 结果可视化和导出

## 打包说明
本项目已使用 PyInstaller 打包为独立的可执行文件，无需安装 Python 环境即可运行。

## 可执行文件
- `XJ-EnergyBalanceSystem.exe` - 英文名称版本
- `XJ-能源平衡计算系统.exe` - 中文名称版本

## 主要功能模块
- 项目管理界面
- 数据导入标签页（📊 数据）
- 函数设置标签页（⚙️ 设置）
- 检修和投产计划标签页（🔧 检修和投产计划）
- 计算结果标签页（📈 结果）

## 修复说明
- 修复了打包后标签页显示不完整的问题
- 解决了设置页面中"最大电力负荷"输入框及后续控件未加载的问题
- 添加了更多必要的隐藏导入，特别是tkinter相关模块和UI组件
- 确保所有UI组件（包括Listbox、Entry、Button、LabelFrame等）都能正确加载

## 使用说明
1. 双击运行可执行文件
2. 系统将启动能源平衡计算界面
3. 可通过项目管理界面创建新项目或打开已有项目
4. 导入数据后进行计算和分析

## 注意事项
- 程序首次启动可能需要几秒钟时间
- 确保有足够的磁盘空间（程序文件约40MB）
- 如果遇到任何问题，请检查原始Python环境是否正常运行

## 依赖项
- tkinter (Python GUI库)
- matplotlib (绘图库)
- numpy (数值计算库)
- openpyxl (Excel文件处理库)
- csv, json, os, datetime (Python标准库)

## 打包配置
- 使用 spec 文件进行配置
- 包含必要的数据文件 (data_template.csv)
- 隐藏控制台窗口（GUI应用）
- 包含所有必要的隐藏导入，特别是tkinter的各个子模块

## 问题排查
如果可执行文件无法运行：
1. 确保操作系统为 Windows 10 或更高版本
2. 尝试以管理员身份运行
3. 检查防病毒软件是否误报
4. 确保系统有足够的内存和存储空间

## 已解决的问题
- 标签页显示不完整问题
- 设置页面UI组件加载不全问题
- 最大电力负荷输入框及后续控件缺失问题